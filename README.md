# Скрапер для Ozon.ru

Этот скрипт предназначен для сбора информации о товарах с сайта Ozon.ru. Он использует Selenium и `undetected-chromedriver` для эмуляции поведения реального пользователя и сбора динамически загружаемых данных.

## Принцип работы

Скрипт использует гибридный подход для максимальной скорости и надёжности:

1.  **JSON-LD для быстрых данных**: Основная информация (название, описание, цена) мгновенно извлекается из `JSON-LD` — структурированных данных на странице.
2.  **Selenium для динамического контента**: Для извлечения данных, требующих взаимодействия со страницей (характеристики, URL изображений), используется Selenium.
3.  **Эффективные ожидания**: Вместо ненадёжных статичных пауз (`time.sleep`) скрипт использует "умные" ожидания (`WebDriverWait`). Он продолжает работу сразу после появления нужных элементов на странице.
4.  **Сбор изображений**: Скрипт сначала сохраняет URL основного изображения. Затем он последовательно кликает на миниатюры вариантов товара и ждёт, пока URL главного изображения действительно не изменится, прежде чем сохранить новую ссылку.

## Возможности

-   Собирает название, цену, валюту и текстовое описание.
-   Парсит все характеристики товара в виде структурированного списка.
-   Извлекает URL-адреса всех изображений (из основной галереи и из блока с описанием).
-   Выводит все собранные данные в удобном формате JSON.
-   Поддерживает режим подробного вывода (`--verbose`) и отображения окна браузера (`--show-window`) для отладки.

## Требования

-   Python 3.x
-   pip

## Установка

1.  Склонируйте репозиторий.
2.  (Рекомендуется) Перейдите в директорию проекта, создайте и активируйте виртуальное окружение:
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```
3.  Установите необходимые зависимости:
    ```bash
    pip install -r requirements.txt
    ```

## Использование

Для запуска скрипта передайте ему URL страницы товара на Ozon.ru.

**Базовый пример:**
```bash
python3 scraper.py "https://www.ozon.ru/product/..."
```

**Примеры для отладки:**
Флаг `--verbose` (`-v`) включает подробный лог в консоль. Флаг `--show-window` принудительно показывает окно браузера. В режиме `--verbose` окно также будет показано.

```bash
# Подробный лог + видимый браузер
python3 scraper.py "https://www.ozon.ru/product/..." -v

# Только показать браузер без лога
python3 scraper.py "https://www.ozon.ru/product/..." --show-window
```

## Формат вывода

Скрипт выводит результат в стандартный поток вывода (stdout) в виде JSON-объекта.

**Пример вывода:**
```json
{
  "name": "Смартфон Apple iPhone 15 Pro Max, 256 ГБ, nano-SIM + eSIM, синий титан",
  "description": "Смартфон Apple iPhone 15 Pro Max. Чип A17 Pro. Титановый корпус. Настраиваемая кнопка действия. Система камер Pro.",
  "price": 139990,
  "price_currency": "RUB",
  "characteristics": [
    {
      "name": "Емкость аккумулятора, мАч",
      "value": "4422"
    },
    {
      "name": "NFC",
      "value": "Да"
    },
    {
      "name": "Процессор",
      "value": "A17 Pro"
    }
  ],
  "image_urls": [
    "https://ir.ozone.ru/s3/multimedia-q/wc1000/6698012759.jpg",
    "https://ir.ozone.ru/s3/multimedia-p/wc1000/6698012751.jpg",
    "https://ir.ozone.ru/s3/multimedia-r/wc1000/6698012753.jpg"
  ]
}
```
---
**Примечание:** Скрейпинг может нарушать условия использования веб-сайтов. Используйте этот инструмент ответственно.